<!--
  Copyright 2021 Google LLC

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

{% extends "base.html" %}

{% block title %}Play Quiz{% endblock %}

{% block content %}


{% if quiz == None %}
    <div class="mdc-layout-grid">
        <div class="mdc-layout-grid__inner">
            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                <h2>Error: unknown quiz with pin {{ pin }}</h2>
            </div>
        </div>
    </div>
{% else %}
    <div class="question show">
        <div class="play-header">
            <div class="title">{{ quiz.name }}</div>
            <div class="timer">
                <div class="time-left-txt">Time Left</div>
                <div class="timer-sec">{{ quiz.time_limit }}</div>
            </div>
            <div class="time-line"></div>
        </div>
        <section>
            <div class="question-text"></div>
            <div class="option-list"></div>
        </section>

        <div class="play-footer">
            <div class="total-questions"></div>
            <button class="next-btn">Next</button>
        </div>
    </div>
    <section class="results hide">
        <div class="results-header">
            <h2>Results</h2>
            <div class="score-text"></div>
            <div class="buttons">
                <button class="restart">Retake Quiz</button>
                <button class="home">Take me to the Quizrd Home Page</button>
            </div>  
        </div>      
    </section>

    <!--
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    -->

    <script type="module" nonce="{{ g.csp_nonce }}">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
        import { doc, getDoc, getFirestore, collection, getDocs, onSnapshot } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyCWY14Mna0pyz15Jcv2jLSq5eVxc2XCHfU",
          authDomain: "quizrd-prod-382117.firebaseapp.com",
          projectId: "quizrd-prod-382117",
          storageBucket: "quizrd-prod-382117.appspot.com",
          messagingSenderId: "338739261213",
          appId: "1:338739261213:web:49d62e4552ffaabcbe7bf4"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const unsub = onSnapshot(doc(db, "admin", "quizManagement"), (doc) => {
            showNextQuestion();
        });
    </script>
    <script type="text/javascript" nonce="{{ g.csp_nonce }}">
        let link = document.createElement( "link" );
        link.href = "/static/play.css";
        link.type = "text/css";
        link.rel = "stylesheet";
        link.media = "screen,print";
        document.getElementsByTagName("head")[0].appendChild(link);
    </script>
    <script src="/static/play.js" data-timelimit="{{ quiz.time_limit }}" data-qanda="{{ quiz.qand_a }}" type="text/javascript" nonce="{{ g.csp_nonce }}"></script>

{% endif %}
{% endblock %}
